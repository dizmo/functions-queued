{"version":3,"sources":["index.js"],"names":["Object","defineProperty","exports","value","functions_random_1","require","Queue","options","_name","_auto","_running","_queue","undefined","auto","name","random","_q","callback","push","dequeue","shift","flag","fn","functions","q","qn","args","enqueue","apply","concat","fi","next","queued","call","default"],"mappings":"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","file":"index.js","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/* tslint:disable ban-types */\n/* tslint:disable member-ordering */\n/* tslint:disable trailing-comma */\n/* tslint:disable variable-name */\nconst functions_random_1 = require(\"@dizmo/functions-random\");\nclass Queue {\n    constructor(options) {\n        this._name = \"\";\n        this._auto = false;\n        this._running = false;\n        this._queue = [];\n        if (options === undefined) {\n            options = {};\n        }\n        this._auto = options.auto !== undefined\n            ? options.auto : true;\n        this._name = options.name\n            ? options.name : functions_random_1.random(8);\n        if (Queue._q[this._name] === undefined) {\n            Queue._q[this._name] = [];\n        }\n        this._queue = Queue._q[this._name];\n    }\n    enqueue(callback) {\n        this._queue.push(() => {\n            if (callback()) {\n                this.dequeue();\n            }\n        });\n        if (this._auto && !this._running) {\n            this.dequeue();\n        }\n        return this;\n    }\n    dequeue() {\n        this._running = false;\n        const shift = this._queue.shift();\n        if (shift) {\n            this._running = true;\n            shift();\n        }\n        return shift;\n    }\n}\nQueue._q = {};\nexports.Queue = Queue;\nexports.auto = (flag) => (fn, ...functions) => {\n    const q = new Queue({\n        auto: flag, name: fn.name\n    });\n    const qn = (...args) => {\n        q.enqueue(() => fn.apply(null, args.concat([\n            () => q.dequeue()\n        ])));\n        for (const fi of functions) {\n            q.enqueue(() => fi.apply(null, args.concat([\n                () => q.dequeue()\n            ])));\n        }\n    };\n    qn.next = () => {\n        q.dequeue();\n    };\n    return qn;\n};\nexports.queued = (fn, ...functions) => {\n    return exports.auto(true).call(null, fn, ...functions);\n};\nexports.queued.auto = exports.auto;\nexports.default = exports.queued;\n"]}