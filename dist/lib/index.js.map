{"version":3,"sources":["index.js"],"names":["Object","defineProperty","exports","value","functions_random_1","require","Queue","options","_name","_auto","_running","_queue","undefined","auto","name","random","_q","callback","push","dequeue","shift","flag","fn","functions","q","qn","args","enqueue","apply","concat","fi","next","queued","call"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/* tslint:disable ban-types */\n/* tslint:disable member-ordering */\n/* tslint:disable trailing-comma */\n/* tslint:disable variable-name */\nconst functions_random_1 = require(\"@dizmo/functions-random\");\nclass Queue {\n    constructor(options) {\n        this._name = \"\";\n        this._auto = false;\n        this._running = false;\n        this._queue = [];\n        if (options === undefined) {\n            options = {};\n        }\n        this._auto = options.auto !== undefined\n            ? options.auto : true;\n        this._name = options.name\n            ? options.name : functions_random_1.random(8);\n        if (Queue._q[this._name] === undefined) {\n            Queue._q[this._name] = [];\n        }\n        this._queue = Queue._q[this._name];\n    }\n    enqueue(callback) {\n        this._queue.push(() => {\n            if (callback()) {\n                this.dequeue();\n            }\n        });\n        if (this._auto && !this._running) {\n            this.dequeue();\n        }\n        return this;\n    }\n    dequeue() {\n        this._running = false;\n        const shift = this._queue.shift();\n        if (shift) {\n            this._running = true;\n            shift();\n        }\n        return shift;\n    }\n}\nQueue._q = {};\nexports.Queue = Queue;\nexports.auto = (flag) => (fn, ...functions) => {\n    const q = new Queue({\n        auto: flag, name: fn.name\n    });\n    const qn = (...args) => {\n        q.enqueue(() => fn.apply(null, args.concat([\n            () => q.dequeue()\n        ])));\n        for (const fi of functions) {\n            q.enqueue(() => fi.apply(null, args.concat([\n                () => q.dequeue()\n            ])));\n        }\n    };\n    qn.next = () => {\n        q.dequeue();\n    };\n    return qn;\n};\nexports.queued = (fn, ...functions) => {\n    return exports.auto(true).call(null, fn, ...functions);\n};\nexports.queued.auto = exports.auto;\nexports.default = exports.queued;\n"],"file":"index.js"}